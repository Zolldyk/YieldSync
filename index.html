<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YieldSync - DeFi Yield Aggregator on BlockDAG</title>

    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/x-icon" href="./assets/images/favicon.ico">
    <link rel="apple-touch-icon" href="./assets/images/logo.png">

    <!-- Meta Tags for SEO and Social Media -->
    <meta name="description"
        content="YieldSync - Decentralized Yield Aggregator on BlockDAG. Maximize your DeFi returns with automated yield optimization, governance participation, and community-driven rewards.">
    <meta name="keywords" content="DeFi, Yield Farming, BlockDAG, Crypto, Decentralized Finance, Yield Aggregator">
    <meta name="author" content="YieldSync Team">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yieldsync.app/">
    <meta property="og:title" content="YieldSync - DeFi Yield Aggregator on BlockDAG">
    <meta property="og:description"
        content="Maximize your DeFi returns with automated yield optimization and governance participation.">
    <meta property="og:image" content="./assets/images/social-preview.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://yieldsync.app/">
    <meta property="twitter:title" content="YieldSync - DeFi Yield Aggregator on BlockDAG">
    <meta property="twitter:description"
        content="Maximize your DeFi returns with automated yield optimization and governance participation.">
    <meta property="twitter:image" content="./assets/images/social-preview.png">

    <!-- External Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.9.0/ethers.umd.min.js"></script>

    <style>
        /* ============ Global Styles ============ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --success-color: #48bb78;
            --warning-color: #ed8936;
            --error-color: #f56565;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --background-light: rgba(255, 255, 255, 0.95);
            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 8px 25px rgba(0, 0, 0, 0.15);
            --shadow-heavy: 0 15px 35px rgba(0, 0, 0, 0.2);
            --border-radius: 12px;
            --border-radius-lg: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ============ Loading Overlay ============ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
            font-size: 1.2rem;
            transition: opacity 0.5s ease;
        }

        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            opacity: 0.8;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.8;
            }

            50% {
                opacity: 1;
            }
        }

        /* ============ Header ============ */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        .header h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
            font-weight: 800;
            background: linear-gradient(45deg, #fff, #f0f8ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .version {
            font-size: 0.9rem;
            opacity: 0.7;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            backdrop-filter: blur(10px);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============ Cards ============ */
        .card {
            background: var(--background-light);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-heavy);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: fadeInUp 1s ease-out;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============ Network Banner ============ */
        .network-banner {
            background: linear-gradient(135deg, var(--warning-color), #ff7b7b);
            color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 20px;
            font-weight: 600;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============ Wallet Section ============ */
        .wallet-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .wallet-info {
            flex: 1;
            min-width: 250px;
        }

        .wallet-address {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .wallet-balance {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .network-info {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ============ Buttons ============ */
        .button {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            min-width: 140px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .button:active {
            transform: translateY(0);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .primary-button {
            background: linear-gradient(135deg, var(--success-color), #38a169);
            font-size: 1.1rem;
            padding: 15px 30px;
        }

        .secondary-button {
            background: linear-gradient(135deg, #718096, #4a5568);
        }

        .emergency-btn {
            background: linear-gradient(135deg, var(--error-color), #e53e3e);
            margin-top: 15px;
        }

        .max-button {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        /* ============ Stats Grid ============ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.1));
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* ============ Health Indicators ============ */
        .vault-health {
            border-left: 4px solid var(--success-color);
        }

        .health-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .health-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .health-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .health-value {
            font-weight: 700;
            color: var(--success-color);
        }

        /* ============ Tabs ============ */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 5px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            background: transparent;
            border: none;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-secondary);
            min-width: 120px;
        }

        .tab.active {
            background: white;
            color: var(--primary-color);
            box-shadow: var(--shadow-light);
        }

        .tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        /* ============ Tab Content ============ */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content h2 {
            margin-bottom: 25px;
            color: var(--text-primary);
            font-size: 1.8rem;
            font-weight: 700;
        }

        /* ============ Form Sections ============ */
        .form-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            padding: 25px;
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-wrapper input {
            flex: 1;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.9);
            transition: var(--transition);
        }

        .input-wrapper input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-wrapper .max-button {
            margin-left: 10px;
        }

        /* ============ Info Grid ============ */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-label {
            font-weight: 500;
            color: var(--text-secondary);
        }

        .info-value {
            font-weight: 700;
            color: var(--primary-color);
        }

        /* ============ Governance Section ============ */
        .governance-stats {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .governance-section {
            margin-top: 20px;
        }

        .governance-section h3 {
            margin-bottom: 15px;
            color: var(--text-primary);
            font-size: 1.3rem;
        }

        /* ============ Notifications ============ */
        .notifications-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            max-width: 400px;
        }

        .notification {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--shadow-heavy);
            border-left: 4px solid var(--success-color);
            animation: slideInRight 0.5s ease-out;
            position: relative;
        }

        .notification.error {
            border-left-color: var(--error-color);
        }

        .notification.warning {
            border-left-color: var(--warning-color);
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notification-title {
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .notification-message {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .notification-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-secondary);
        }

        /* ============ Pools Grid ============ */
        .pools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .pool-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .pool-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .pool-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .pool-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .pool-apy {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--success-color);
        }

        .pool-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .pool-stat {
            text-align: center;
        }

        .pool-stat-value {
            font-weight: 700;
            color: var(--primary-color);
        }

        .pool-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* ============ Utility Classes ============ */
        .hidden {
            display: none !important;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        .text-success {
            color: var(--success-color) !important;
        }

        .text-error {
            color: var(--error-color) !important;
        }

        .text-warning {
            color: var(--warning-color) !important;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* ============ Responsive Design ============ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .wallet-section {
                flex-direction: column;
                text-align: center;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                flex: none;
                margin-bottom: 5px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .card {
                padding: 20px;
            }

            .notifications-container {
                position: fixed;
                top: 10px;
                left: 10px;
                right: 10px;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }

            .header .subtitle {
                font-size: 1.1rem;
            }

            .card {
                padding: 15px;
            }

            .form-section {
                padding: 20px;
            }
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Initializing YieldSync...</div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container hidden">
        <!-- Header -->
        <div class="header">
            <h1>🚀 YieldSync</h1>
            <div class="subtitle">Decentralized Yield Aggregator on BlockDAG</div>
            <div class="version">v<span id="appVersion">1.0.1</span> - Primordial Testnet</div>
        </div>

        <!-- Network Status Banner -->
        <div id="networkBanner" class="network-banner hidden">
            <span id="networkStatus">⚠️ Please switch to BlockDAG Primordial Testnet</span>
        </div>

        <!-- Wallet Connection -->
        <div id="walletSection" class="wallet-section card">
            <div class="wallet-info">
                <div id="walletAddress" class="wallet-address">Not Connected</div>
                <div id="walletBalance" class="wallet-balance">0 BDAG</div>
                <div id="networkInfo" class="network-info">Chain ID: <span id="chainId">-</span></div>
            </div>
            <button id="connectWallet" class="button">Connect Wallet</button>
        </div>

        <!-- Notifications Container -->
        <div id="notifications" class="notifications-container"></div>

        <!-- Protocol Stats -->
        <div class="card">
            <h2>📊 Protocol Overview</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div id="totalTVL" class="stat-value">$0</div>
                    <div class="stat-label">Total Value Locked</div>
                </div>
                <div class="stat-card">
                    <div id="totalUsers" class="stat-value">0</div>
                    <div class="stat-label">Active Users</div>
                </div>
                <div class="stat-card">
                    <div id="avgAPY" class="stat-value">0%</div>
                    <div class="stat-label">Average APY</div>
                </div>
                <div class="stat-card">
                    <div id="totalYield" class="stat-value">$0</div>
                    <div class="stat-label">Total Yield Generated</div>
                </div>
            </div>
        </div>

        <!-- Vault Health Indicator -->
        <div id="vaultHealth" class="card vault-health">
            <h3>🏥 Vault Health</h3>
            <div class="health-indicators">
                <div class="health-item">
                    <span class="health-label">Status:</span>
                    <span id="healthStatus" class="health-value">Healthy</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Liquidity:</span>
                    <span id="liquidityRatio" class="health-value">85%</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Utilization:</span>
                    <span id="utilizationRate" class="health-value">75%</span>
                </div>
            </div>
        </div>

        <!-- Main Interface -->
        <div class="card">
            <div class="tabs">
                <button class="tab active" data-tab="deposit">💰 Deposit</button>
                <button class="tab" data-tab="withdraw">🏦 Withdraw</button>
                <button class="tab" data-tab="governance">🗳️ Governance</button>
                <button class="tab" data-tab="pools">🏊 Pools</button>
                <button class="tab" data-tab="analytics">📈 Analytics</button>
            </div>

            <!-- Deposit Tab -->
            <div id="depositTab" class="tab-content active">
                <h2>💰 Deposit Assets</h2>
                <div class="form-section">
                    <div class="input-group">
                        <label for="depositAmount">Amount (BDAG)</label>
                        <div class="input-wrapper">
                            <input type="number" id="depositAmount" placeholder="0.0" step="0.000001" min="0">
                            <button class="max-button" onclick="setMaxDeposit()">MAX</button>
                        </div>
                    </div>

                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Your Balance:</span>
                            <span id="userBalance" class="info-value">0 BDAG</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Expected Shares:</span>
                            <span id="expectedShares" class="info-value">0 YSV</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Current APY:</span>
                            <span id="currentAPY" class="info-value">0%</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Exchange Rate:</span>
                            <span id="exchangeRate" class="info-value">1:1</span>
                        </div>
                    </div>

                    <button id="depositBtn" class="button primary-button" onclick="deposit()">
                        <span id="depositBtnText">Deposit Assets</span>
                        <div id="depositLoading" class="loading hidden"></div>
                    </button>
                </div>
            </div>

            <!-- Withdraw Tab -->
            <div id="withdrawTab" class="tab-content">
                <h2>🏦 Withdraw Assets</h2>
                <div class="form-section">
                    <div class="input-group">
                        <label for="withdrawAmount">Shares to Withdraw (YSV)</label>
                        <div class="input-wrapper">
                            <input type="number" id="withdrawAmount" placeholder="0.0" step="0.000001" min="0">
                            <button class="max-button" onclick="setMaxWithdraw()">ALL</button>
                        </div>
                    </div>

                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Your Shares:</span>
                            <span id="userShares" class="info-value">0 YSV</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Expected Amount:</span>
                            <span id="expectedAmount" class="info-value">0 BDAG</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Withdrawal Fee:</span>
                            <span id="withdrawalFee" class="info-value">0 BDAG</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Net Amount:</span>
                            <span id="netWithdrawAmount" class="info-value">0 BDAG</span>
                        </div>
                    </div>

                    <button id="withdrawBtn" class="button primary-button" onclick="withdraw()">
                        <span id="withdrawBtnText">Withdraw Assets</span>
                        <div id="withdrawLoading" class="loading hidden"></div>
                    </button>

                    <button id="emergencyWithdrawBtn" class="button secondary-button emergency-btn"
                        onclick="emergencyWithdraw()">
                        🚨 Emergency Withdraw (No Fees)
                    </button>
                </div>
            </div>

            <!-- Governance Tab -->
            <div id="governanceTab" class="tab-content">
                <h2>🗳️ Governance & Yield Sharing</h2>

                <div class="governance-stats">
                    <div class="stat-item">
                        <span class="stat-label">Your Voting Power:</span>
                        <span id="votingPower" class="stat-value">0 YSG</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Community Pool:</span>
                        <span id="communityPool" class="stat-value">0 BDAG</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Your Yield Shared:</span>
                        <span id="userYieldShared" class="stat-value">0 BDAG</span>
                    </div>
                </div>

                <div class="governance-section">
                    <h3>💝 Share Yield & Earn Governance Tokens</h3>
                    <div class="form-section">
                        <div class="input-group">
                            <label for="yieldShareAmount">Vault Shares to Share</label>
                            <input type="number" id="yieldShareAmount" placeholder="0.0" step="0.000001" min="0">
                        </div>

                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Expected Gov Tokens:</span>
                                <span id="expectedGovTokens" class="info-value">0 YSG</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Sharing Rate:</span>
                                <span id="sharingRate" class="info-value">1000:1</span>
                            </div>
                        </div>

                        <button id="shareYieldBtn" class="button primary-button" onclick="shareYield()">
                            <span id="shareYieldBtnText">Share Yield</span>
                            <div id="shareYieldLoading" class="loading hidden"></div>
                        </button>
                    </div>
                </div>

                <div class="governance-section">
                    <h3>📝 Active Proposals</h3>
                    <div id="proposalsList">
                        <div class="pool-card">
                            <div class="pool-header">
                                <div class="pool-name">Proposal #1</div>
                                <div class="pool-apy text-warning">Active</div>
                            </div>
                            <p style="margin-bottom: 15px; color: var(--text-secondary);">
                                Increase performance fee to 2.5% to fund development
                            </p>
                            <div class="pool-stats">
                                <div class="pool-stat">
                                    <div class="pool-stat-value">65%</div>
                                    <div class="pool-stat-label">For Votes</div>
                                </div>
                                <div class="pool-stat">
                                    <div class="pool-stat-value">35%</div>
                                    <div class="pool-stat-label">Against Votes</div>
                                </div>
                            </div>
                            <div style="margin-top: 15px; display: flex; gap: 10px;">
                                <button class="button" onclick="vote(1, true)" style="flex: 1;">Vote For</button>
                                <button class="button secondary-button" onclick="vote(1, false)" style="flex: 1;">Vote
                                    Against</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pools Tab -->
            <div id="poolsTab" class="tab-content">
                <h2>🏊 Liquidity Pools</h2>
                <div class="pools-grid">
                    <div class="pool-card">
                        <div class="pool-header">
                            <div class="pool-name">🏪 AMM Pool</div>
                            <div class="pool-apy">8.5%</div>
                        </div>
                        <div class="pool-stats">
                            <div class="pool-stat">
                                <div class="pool-stat-value">$125K</div>
                                <div class="pool-stat-label">TVL</div>
                            </div>
                            <div class="pool-stat">
                                <div class="pool-stat-value">35%</div>
                                <div class="pool-stat-label">Allocation</div>
                            </div>
                        </div>
                    </div>

                    <div class="pool-card">
                        <div class="pool-header">
                            <div class="pool-name">🏦 Lending Pool</div>
                            <div class="pool-apy">12.3%</div>
                        </div>
                        <div class="pool-stats">
                            <div class="pool-stat">
                                <div class="pool-stat-value">$89K</div>
                                <div class="pool-stat-label">TVL</div>
                            </div>
                            <div class="pool-stat">
                                <div class="pool-stat-value">25%</div>
                                <div class="pool-stat-label">Allocation</div>
                            </div>
                        </div>
                    </div>

                    <div class="pool-card">
                        <div class="pool-header">
                            <div class="pool-name">🥩 Staking Pool</div>
                            <div class="pool-apy">15.7%</div>
                        </div>
                        <div class="pool-stats">
                            <div class="pool-stat">
                                <div class="pool-stat-value">$156K</div>
                                <div class="pool-stat-label">TVL</div>
                            </div>
                            <div class="pool-stat">
                                <div class="pool-stat-value">40%</div>
                                <div class="pool-stat-label">Allocation</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analyticsTab" class="tab-content">
                <h2>📈 Analytics & Performance</h2>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">+24.5%</div>
                        <div class="stat-label">7-Day Performance</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">+156.8%</div>
                        <div class="stat-label">30-Day Performance</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">85.4%</div>
                        <div class="stat-label">Best Pool Allocation</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">12</div>
                        <div class="stat-label">Rebalances This Month</div>
                    </div>
                </div>

                <div class="card"
                    style="margin-top: 20px; background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));">
                    <h3>📊 Yield Distribution</h3>
                    <div style="margin-top: 20px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span>Staking Pool (40%)</span>
                            <span class="text-success">15.7% APY</span>
                        </div>
                        <div
                            style="width: 100%; background: rgba(255,255,255,0.2); border-radius: 10px; height: 8px; margin-bottom: 15px;">
                            <div
                                style="width: 40%; background: var(--success-color); border-radius: 10px; height: 100%;">
                            </div>
                        </div>

                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span>AMM Pool (35%)</span>
                            <span class="text-success">8.5% APY</span>
                        </div>
                        <div
                            style="width: 100%; background: rgba(255,255,255,0.2); border-radius: 10px; height: 8px; margin-bottom: 15px;">
                            <div
                                style="width: 35%; background: var(--primary-color); border-radius: 10px; height: 100%;">
                            </div>
                        </div>

                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span>Lending Pool (25%)</span>
                            <span class="text-success">12.3% APY</span>
                        </div>
                        <div style="width: 100%; background: rgba(255,255,255,0.2); border-radius: 10px; height: 8px;">
                            <div
                                style="width: 25%; background: var(--warning-color); border-radius: 10px; height: 100%;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Information -->
        <div class="card">
            <div style="text-align: center; color: var(--text-secondary);">
                <p style="margin-bottom: 10px;">
                    <strong>⚠️ Testnet Notice:</strong> This is a demo running on BlockDAG Primordial Testnet.
                    Do not use real funds.
                </p>
                <p style="font-size: 0.9rem;">
                    Built with ❤️ for the BlockDAG Hackathon 2025 |
                    <a href="https://github.com/Zolldyk" target="_blank"
                        style="color: var(--primary-color);">
                        View on GitHub
                    </a>
                </p>
            </div>
        </div>
    </div>

    <script>
        // ============ Global Variables ============
        let web3;
        let userAccount;
        let contracts = {};

        // BlockDAG Primordial Testnet Configuration
        const BLOCKDAG_CONFIG = {
            chainId: '0x413', // 1043 in hex
            chainName: 'Primordial BlockDAG Testnet',
            nativeCurrency: {
                name: 'BDAG',
                symbol: 'BDAG',
                decimals: 18
            },
            rpcUrls: ['https://test-rpc.primordial.bdagscan.com'],
            blockExplorerUrls: ['https://primordial.bdagscan.com/']
        };

        // Deployed contract addresses on BlockDAG Primordial Testnet
        const CONTRACT_ADDRESSES = {
            vault: '0xE63cE0E709eB6E7f345133C681Ba177df603e804',
            aggregator: '0xCB30C36cfaAa32b059138E302281dB4B8e50eD8c',
            governance: '0x7412634B3189546549898000929A72600EF52b82',
            feeOptimizer: '0x90aF6FD2d47144a72B1e1D482C4208006Dba4f29',
            mockToken: '0x9589a024a960db2B63367a1e8bF659cBBa3215FD'
        };

        // ============ Initialization ============
        document.addEventListener('DOMContentLoaded', async function () {
            console.log('🚀 YieldSync Frontend Initializing...');

            // Initialize the application
            await initializeApp();

            // Setup event listeners
            setupEventListeners();

            // Hide loading overlay and show main app immediately after initialization
            document.getElementById('loadingOverlay').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            showNotification('✅ YieldSync Initialized', 'Application loaded successfully!', 'success');
        });

        // ============ App Initialization ============
        async function initializeApp() {
            try {
                // Check if MetaMask is installed
                if (typeof window.ethereum !== 'undefined') {
                    console.log('✅ MetaMask detected');

                    // Initialize ethers
                    if (typeof ethers !== 'undefined') {
                        web3 = new ethers.BrowserProvider(window.ethereum);
                        console.log('✅ Ethers initialized');
                    } else {
                        console.error('❌ Ethers not loaded');
                        showNotification('❌ Error', 'Ethers library not loaded', 'error');
                        return;
                    }

                    // Check if already connected
                    const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                    if (accounts.length > 0) {
                        await connectWallet();
                    }

                    // Listen for account changes
                    window.ethereum.on('accountsChanged', handleAccountsChanged);
                    window.ethereum.on('chainChanged', handleChainChanged);

                } else {
                    console.warn('⚠️ MetaMask not detected');
                    showNotification('⚠️ MetaMask Required', 'Please install MetaMask to use this dApp', 'warning');
                }

                // Initialize mock data
                updateMockData();

            } catch (error) {
                console.error('❌ Initialization error:', error);
                showNotification('❌ Initialization Error', error.message, 'error');
            }
        }

        // ============ Event Listeners Setup ============
        function setupEventListeners() {
            // Wallet connection
            document.getElementById('connectWallet').addEventListener('click', connectWallet);

            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });

            // Input event listeners for real-time calculations
            document.getElementById('depositAmount').addEventListener('input', updateDepositInfo);
            document.getElementById('withdrawAmount').addEventListener('input', updateWithdrawInfo);
            document.getElementById('yieldShareAmount').addEventListener('input', updateGovernanceInfo);
        }

        // ============ Wallet Functions ============
        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    showNotification('❌ MetaMask Required', 'Please install MetaMask to connect your wallet', 'error');
                    return;
                }

                // Request account access
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });

                if (accounts.length === 0) {
                    showNotification('❌ Connection Failed', 'No accounts found', 'error');
                    return;
                }

                userAccount = accounts[0];

                // Get network info
                const network = await web3.getNetwork();
                const balance = await web3.getBalance(userAccount);

                // Update UI
                document.getElementById('walletAddress').textContent =
                    `${userAccount.slice(0, 6)}...${userAccount.slice(-4)}`;
                document.getElementById('walletBalance').textContent =
                    `${ethers.formatEther(balance).slice(0, 8)} BDAG`;
                document.getElementById('chainId').textContent = network.chainId.toString();
                document.getElementById('connectWallet').textContent = 'Connected';
                document.getElementById('connectWallet').style.background = 'var(--success-color)';

                // Check if on correct network
                if (network.chainId.toString() !== '1043') {
                    document.getElementById('networkBanner').classList.remove('hidden');
                    showNotification('⚠️ Wrong Network', 'Please switch to BlockDAG Primordial Testnet', 'warning');
                } else {
                    document.getElementById('networkBanner').classList.add('hidden');
                    showNotification('✅ Wallet Connected', `Connected to ${userAccount.slice(0, 6)}...${userAccount.slice(-4)}`, 'success');
                }

                // Initialize contracts (mock for now)
                await initializeContracts();

                // Update user-specific data
                await updateUserData();

            } catch (error) {
                console.error('❌ Wallet connection error:', error);
                showNotification('❌ Connection Failed', error.message, 'error');
            }
        }

        async function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                // User disconnected
                userAccount = null;
                document.getElementById('walletAddress').textContent = 'Not Connected';
                document.getElementById('walletBalance').textContent = '0 BDAG';
                document.getElementById('chainId').textContent = '-';
                document.getElementById('connectWallet').textContent = 'Connect Wallet';
                document.getElementById('connectWallet').style.background = '';
                showNotification('👋 Wallet Disconnected', 'Wallet has been disconnected', 'warning');
            } else if (accounts[0] !== userAccount) {
                // User changed account
                await connectWallet();
            }
        }

        async function handleChainChanged(chainId) {
            // Reload page on chain change for simplicity
            window.location.reload();
        }

        async function switchToBlockDAG() {
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: BLOCKDAG_CONFIG.chainId }],
                });
            } catch (error) {
                if (error.code === 4902) {
                    // Chain not added, add it
                    try {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [BLOCKDAG_CONFIG],
                        });
                    } catch (addError) {
                        console.error('❌ Failed to add BlockDAG network:', addError);
                        showNotification('❌ Network Error', 'Failed to add BlockDAG network', 'error');
                    }
                } else {
                    console.error('❌ Failed to switch to BlockDAG:', error);
                    showNotification('❌ Network Error', 'Failed to switch to BlockDAG network', 'error');
                }
            }
        }

        // ============ Contract Initialization ============
        async function initializeContracts() {
            try {
                // Mock contract initialization
                // In production, you would initialize actual contract instances here
                console.log('📄 Initializing contracts...');

                // Example contract ABI (simplified)
                const mockABI = [
                    "function deposit(uint256 amount) external returns (uint256)",
                    "function withdraw(uint256 shares) external returns (uint256)",
                    "function balanceOf(address account) external view returns (uint256)",
                    "function totalAssets() external view returns (uint256)"
                ];

                // Initialize contract instances (mock)
                contracts.vault = new ethers.Contract(CONTRACT_ADDRESSES.vault, mockABI, await web3.getSigner());
                contracts.governance = new ethers.Contract(CONTRACT_ADDRESSES.governance, mockABI, await web3.getSigner());

                console.log('✅ Contracts initialized');

            } catch (error) {
                console.error('❌ Contract initialization error:', error);
                showNotification('❌ Contract Error', 'Failed to initialize contracts', 'error');
            }
        }

        // ============ Tab Management ============
        function switchTab(tabName) {
            // Remove active class from all tabs and content
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Add active class to selected tab and content
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(`${tabName}Tab`).classList.add('active');

            // Update data for the active tab
            switch (tabName) {
                case 'pools':
                    updatePoolsData();
                    break;
                case 'analytics':
                    updateAnalyticsData();
                    break;
                case 'governance':
                    updateGovernanceData();
                    break;
            }
        }

        // ============ Core Functions ============
        async function deposit() {
            try {
                const amount = document.getElementById('depositAmount').value;

                if (!amount || parseFloat(amount) <= 0) {
                    showNotification('❌ Invalid Amount', 'Please enter a valid deposit amount', 'error');
                    return;
                }

                if (!userAccount) {
                    showNotification('❌ Wallet Required', 'Please connect your wallet first', 'error');
                    return;
                }

                // Show loading state
                setButtonLoading('depositBtn', true);

                // Mock transaction for demo
                showNotification('⏳ Processing', 'Submitting deposit transaction...', 'warning');

                // Simulate transaction time
                await new Promise(resolve => setTimeout(resolve, 3000));

                // Mock success
                showNotification('✅ Deposit Successful', `Deposited ${amount} BDAG successfully!`, 'success');

                // Update UI
                document.getElementById('depositAmount').value = '';
                await updateUserData();
                updateDepositInfo();

            } catch (error) {
                console.error('❌ Deposit error:', error);
                showNotification('❌ Deposit Failed', error.message, 'error');
            } finally {
                setButtonLoading('depositBtn', false);
            }
        }

        async function withdraw() {
            try {
                const shares = document.getElementById('withdrawAmount').value;

                if (!shares || parseFloat(shares) <= 0) {
                    showNotification('❌ Invalid Amount', 'Please enter a valid withdrawal amount', 'error');
                    return;
                }

                if (!userAccount) {
                    showNotification('❌ Wallet Required', 'Please connect your wallet first', 'error');
                    return;
                }

                // Show loading state
                setButtonLoading('withdrawBtn', true);

                // Mock transaction for demo
                showNotification('⏳ Processing', 'Submitting withdrawal transaction...', 'warning');

                // Simulate transaction time
                await new Promise(resolve => setTimeout(resolve, 3000));

                // Mock success
                showNotification('✅ Withdrawal Successful', `Withdrew ${shares} shares successfully!`, 'success');

                // Update UI
                document.getElementById('withdrawAmount').value = '';
                await updateUserData();
                updateWithdrawInfo();

            } catch (error) {
                console.error('❌ Withdrawal error:', error);
                showNotification('❌ Withdrawal Failed', error.message, 'error');
            } finally {
                setButtonLoading('withdrawBtn', false);
            }
        }

        async function emergencyWithdraw() {
            if (!confirm('⚠️ Are you sure you want to perform an emergency withdrawal? This action cannot be undone.')) {
                return;
            }

            try {
                if (!userAccount) {
                    showNotification('❌ Wallet Required', 'Please connect your wallet first', 'error');
                    return;
                }

                // Mock emergency withdrawal
                showNotification('⏳ Processing', 'Performing emergency withdrawal...', 'warning');

                // Simulate transaction time
                await new Promise(resolve => setTimeout(resolve, 2000));

                showNotification('✅ Emergency Withdrawal Complete', 'All funds have been withdrawn', 'success');

                await updateUserData();

            } catch (error) {
                console.error('❌ Emergency withdrawal error:', error);
                showNotification('❌ Emergency Withdrawal Failed', error.message, 'error');
            }
        }

        async function shareYield() {
            try {
                const amount = document.getElementById('yieldShareAmount').value;

                if (!amount || parseFloat(amount) <= 0) {
                    showNotification('❌ Invalid Amount', 'Please enter a valid amount to share', 'error');
                    return;
                }

                if (!userAccount) {
                    showNotification('❌ Wallet Required', 'Please connect your wallet first', 'error');
                    return;
                }

                // Show loading state
                setButtonLoading('shareYieldBtn', true);

                // Mock transaction for demo
                showNotification('⏳ Processing', 'Sharing yield with community...', 'warning');

                // Simulate transaction time
                await new Promise(resolve => setTimeout(resolve, 3000));

                // Mock success
                const govTokensEarned = (parseFloat(amount) * 1000).toFixed(2);
                showNotification('✅ Yield Shared', `Shared ${amount} yield and earned ${govTokensEarned} YSG tokens!`, 'success');

                // Update UI
                document.getElementById('yieldShareAmount').value = '';
                await updateGovernanceData();
                updateGovernanceInfo();

            } catch (error) {
                console.error('❌ Yield sharing error:', error);
                showNotification('❌ Yield Sharing Failed', error.message, 'error');
            } finally {
                setButtonLoading('shareYieldBtn', false);
            }
        }

        async function vote(proposalId, support) {
            try {
                if (!userAccount) {
                    showNotification('❌ Wallet Required', 'Please connect your wallet first', 'error');
                    return;
                }

                const voteType = support ? 'in favor of' : 'against';
                showNotification('⏳ Processing', `Submitting vote ${voteType} proposal #${proposalId}...`, 'warning');

                // Simulate transaction time
                await new Promise(resolve => setTimeout(resolve, 2000));

                showNotification('✅ Vote Submitted', `Successfully voted ${voteType} proposal #${proposalId}`, 'success');

            } catch (error) {
                console.error('❌ Voting error:', error);
                showNotification('❌ Voting Failed', error.message, 'error');
            }
        }

        // ============ Utility Functions ============
        function setMaxDeposit() {
            // Mock setting max balance
            const mockBalance = '1000.0';
            document.getElementById('depositAmount').value = mockBalance;
            updateDepositInfo();
        }

        function setMaxWithdraw() {
            // Mock setting max shares
            const mockShares = '850.5';
            document.getElementById('withdrawAmount').value = mockShares;
            updateWithdrawInfo();
        }

        function updateDepositInfo() {
            const amount = document.getElementById('depositAmount').value;
            if (amount && parseFloat(amount) > 0) {
                document.getElementById('expectedShares').textContent = `${amount} YSV`;
                document.getElementById('exchangeRate').textContent = '1:1';
            } else {
                document.getElementById('expectedShares').textContent = '0 YSV';
                document.getElementById('exchangeRate').textContent = '1:1';
            }
        }

        function updateWithdrawInfo() {
            const shares = document.getElementById('withdrawAmount').value;
            if (shares && parseFloat(shares) > 0) {
                const expectedAmount = parseFloat(shares) * 0.995; // Mock 0.5% fee
                const fee = parseFloat(shares) * 0.005;
                document.getElementById('expectedAmount').textContent = `${shares} BDAG`;
                document.getElementById('withdrawalFee').textContent = `${fee.toFixed(6)} BDAG`;
                document.getElementById('netWithdrawAmount').textContent = `${expectedAmount.toFixed(6)} BDAG`;
            } else {
                document.getElementById('expectedAmount').textContent = '0 BDAG';
                document.getElementById('withdrawalFee').textContent = '0 BDAG';
                document.getElementById('netWithdrawAmount').textContent = '0 BDAG';
            }
        }

        function updateGovernanceInfo() {
            const amount = document.getElementById('yieldShareAmount').value;
            if (amount && parseFloat(amount) > 0) {
                const expectedTokens = parseFloat(amount) * 1000; // Mock 1000:1 ratio
                document.getElementById('expectedGovTokens').textContent = `${expectedTokens.toFixed(2)} YSG`;
            } else {
                document.getElementById('expectedGovTokens').textContent = '0 YSG';
            }
        }

        async function updateUserData() {
            if (!userAccount) return;

            try {
                // Mock user data updates
                document.getElementById('userBalance').textContent = '1,234.56 BDAG';
                document.getElementById('userShares').textContent = '850.5 YSV';
                document.getElementById('votingPower').textContent = '2,500 YSG';
                document.getElementById('userYieldShared').textContent = '45.2 BDAG';

            } catch (error) {
                console.error('❌ Error updating user data:', error);
            }
        }

        function updateMockData() {
            // Update protocol stats with mock data
            document.getElementById('totalTVL').textContent = '$2.4M';
            document.getElementById('totalUsers').textContent = '1,247';
            document.getElementById('avgAPY').textContent = '12.8%';
            document.getElementById('totalYield').textContent = '$145K';
            document.getElementById('currentAPY').textContent = '12.8%';
            document.getElementById('communityPool').textContent = '5,432 BDAG';
        }

        function updatePoolsData() {
            // Mock pools data update
            console.log('📊 Updating pools data...');
        }

        function updateAnalyticsData() {
            // Mock analytics data update
            console.log('📈 Updating analytics data...');
        }

        function updateGovernanceData() {
            // Mock governance data update
            console.log('🗳️ Updating governance data...');
        }

        function setButtonLoading(buttonId, isLoading) {
            const button = document.getElementById(buttonId);
            const text = button.querySelector('span');
            const loading = button.querySelector('.loading');

            if (isLoading) {
                text.classList.add('hidden');
                loading.classList.remove('hidden');
                button.disabled = true;
            } else {
                text.classList.remove('hidden');
                loading.classList.add('hidden');
                button.disabled = false;
            }
        }

        // ============ Notification System ============
        function showNotification(title, message, type = 'success') {
            const notificationsContainer = document.getElementById('notifications');

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <button class="notification-close" onclick="closeNotification(this)">×</button>
                <div class="notification-title">${title}</div>
                <div class="notification-message">${message}</div>
            `;

            notificationsContainer.appendChild(notification);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        function closeNotification(closeButton) {
            closeButton.parentNode.remove();
        }

        // ============ Error Handling ============
        window.addEventListener('error', function (event) {
            console.error('❌ Global error:', event.error);
            showNotification('❌ Application Error', 'An unexpected error occurred', 'error');
        });

        window.addEventListener('unhandledrejection', function (event) {
            console.error('❌ Unhandled promise rejection:', event.reason);
            showNotification('❌ Network Error', 'A network error occurred', 'error');
        });

        // ============ Performance Monitoring ============
        function logPerformanceMetrics() {
            if ('performance' in window) {
                const navigation = performance.getEntriesByType('navigation')[0];
                console.log(`📊 Page Load Time: ${navigation.loadEventEnd - navigation.loadEventStart}ms`);
                console.log(`📊 DOM Content Loaded: ${navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart}ms`);
            }
        }

        // Log performance metrics after page load
        window.addEventListener('load', logPerformanceMetrics);

        // ============ Development Helpers ============
        if (typeof window !== 'undefined') {
            // Add global helpers for debugging
            window.YieldSync = {
                connectWallet,
                updateMockData,
                showNotification,
                switchTab,
                contracts,
                userAccount: () => userAccount,
                version: '1.0.1'
            };

            console.log('🔧 YieldSync debug helpers available at window.YieldSync');
        }

        // ============ Analytics & Tracking ============
        function trackUserAction(action, data = {}) {
            console.log(`📊 User Action: ${action}`, data);

            // In production, you would send this to your analytics service
            // Example: analytics.track(action, { ...data, timestamp: Date.now() });
        }

        // Track tab switches
        const originalSwitchTab = switchTab;
        switchTab = function (tabName) {
            trackUserAction('tab_switch', { tab: tabName });
            return originalSwitchTab(tabName);
        };

        // ============ Accessibility Enhancements ============
        document.addEventListener('keydown', function (event) {
            // Handle keyboard navigation
            if (event.key === 'Escape') {
                // Close any open modals or notifications
                document.querySelectorAll('.notification').forEach(notification => {
                    notification.remove();
                });
            }
        });

        // ============ Mobile Optimizations ============
        function isMobileDevice() {
            return window.innerWidth <= 768;
        }

        function optimizeForMobile() {
            if (isMobileDevice()) {
                // Add mobile-specific optimizations
                document.body.classList.add('mobile-device');

                // Reduce animation duration on mobile for better performance
                document.documentElement.style.setProperty('--transition', 'all 0.2s ease');
            }
        }

        window.addEventListener('resize', optimizeForMobile);
        optimizeForMobile(); // Run on initial load

        // ============ Network Status Monitoring ============
        function updateNetworkStatus() {
            if (!navigator.onLine) {
                showNotification('🔌 Offline', 'You are currently offline. Some features may not work.', 'warning');
            }
        }

        window.addEventListener('online', function () {
            showNotification('🌐 Online', 'Connection restored!', 'success');
        });

        window.addEventListener('offline', updateNetworkStatus);

        // ============ Local Storage Utilities ============
        function saveToLocalStorage(key, data) {
            try {
                localStorage.setItem(`yieldsync_${key}`, JSON.stringify(data));
            } catch (error) {
                console.warn('⚠️ Local storage not available:', error);
            }
        }

        function loadFromLocalStorage(key, defaultValue = null) {
            try {
                const item = localStorage.getItem(`yieldsync_${key}`);
                return item ? JSON.parse(item) : defaultValue;
            } catch (error) {
                console.warn('⚠️ Error loading from local storage:', error);
                return defaultValue;
            }
        }

        // Save user preferences
        function saveUserPreferences() {
            const preferences = {
                lastConnectedWallet: userAccount,
                preferredTab: document.querySelector('.tab.active')?.dataset.tab || 'deposit',
                timestamp: Date.now()
            };
            saveToLocalStorage('preferences', preferences);
        }

        // Load user preferences
        function loadUserPreferences() {
            const preferences = loadFromLocalStorage('preferences');
            if (preferences) {
                // Auto-switch to preferred tab if recently used (within 24 hours)
                if (Date.now() - preferences.timestamp < 24 * 60 * 60 * 1000) {
                    if (preferences.preferredTab && preferences.preferredTab !== 'deposit') {
                        setTimeout(() => switchTab(preferences.preferredTab), 1000);
                    }
                }
            }
        }

        // Save preferences when user interacts
        document.addEventListener('click', function (event) {
            if (event.target.classList.contains('tab')) {
                setTimeout(saveUserPreferences, 100);
            }
        });

        // Load preferences on startup
        setTimeout(loadUserPreferences, 2500);

        // ============ Theme Management ============
        function toggleTheme() {
            const currentTheme = document.body.dataset.theme || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.dataset.theme = newTheme;
            saveToLocalStorage('theme', newTheme);
        }

        function loadTheme() {
            const savedTheme = loadFromLocalStorage('theme', 'light');
            document.body.dataset.theme = savedTheme;
        }

        // Load theme on startup
        loadTheme();

        // ============ Security Helpers ============
        function sanitizeInput(input) {
            if (typeof input !== 'string') return input;
            return input.replace(/[<>\"']/g, '');
        }

        function validateAddress(address) {
            return /^0x[a-fA-F0-9]{40}$/.test(address);
        }

        function validateAmount(amount) {
            const num = parseFloat(amount);
            return !isNaN(num) && num > 0 && num < 1e18; // Reasonable upper limit
        }

        // ============ Data Formatting Utilities ============
        function formatNumber(num, decimals = 2) {
            if (num >= 1e9) {
                return (num / 1e9).toFixed(decimals) + 'B';
            } else if (num >= 1e6) {
                return (num / 1e6).toFixed(decimals) + 'M';
            } else if (num >= 1e3) {
                return (num / 1e3).toFixed(decimals) + 'K';
            } else {
                return num.toFixed(decimals);
            }
        }

        function formatCurrency(amount, currency = 'USD') {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: 2,
                maximumFractionDigits: 6
            }).format(amount);
        }

        function formatPercentage(value) {
            return `${value.toFixed(2)}%`;
        }

        // ============ Auto-refresh Data ============
        function startAutoRefresh() {
            // Refresh protocol stats every 30 seconds
            setInterval(() => {
                if (userAccount) {
                    updateUserData();
                }
                updateMockData();
            }, 30000);

            // Refresh user-specific data every 15 seconds when connected
            setInterval(() => {
                if (userAccount) {
                    updateUserData();
                }
            }, 15000);
        }

        // Start auto-refresh after initialization
        setTimeout(startAutoRefresh, 5000);

        // ============ Clipboard Utilities ============
        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                showNotification('📋 Copied', 'Copied to clipboard!', 'success');
            } catch (error) {
                console.error('❌ Failed to copy to clipboard:', error);
                showNotification('❌ Copy Failed', 'Failed to copy to clipboard', 'error');
            }
        }

        // Add click-to-copy functionality to wallet address
        document.addEventListener('click', function (event) {
            if (event.target.id === 'walletAddress' && userAccount) {
                copyToClipboard(userAccount);
            }
        });

        // ============ Final Initialization Log ============
        console.log(`
        🚀 YieldSync Frontend v1.0.1
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        
        ✅ Frontend initialized successfully
        🌐 Target Network: BlockDAG Primordial Testnet (Chain ID: 1043)
        🔗 RPC Endpoint: https://test-rpc.primordial.bdagscan.com
        📊 Explorer: https://primordial.bdagscan.com
        
        📋 Available Debug Commands:
        • YieldSync.connectWallet() - Connect wallet
        • YieldSync.showNotification(title, message, type) - Show notification
        • YieldSync.switchTab(tabName) - Switch to tab
        • YieldSync.updateMockData() - Update mock data
        
        🛡️ Security Features:
        • Input sanitization
        • Address validation
        • Amount validation
        • XSS protection
        
        📱 Mobile Optimizations: ${isMobileDevice() ? 'Enabled' : 'Disabled'}
        🌐 Network Status: ${navigator.onLine ? 'Online' : 'Offline'}
        
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        Built for BlockDAG Hackathon 2025
        `);
    </script>
</body>

</html>